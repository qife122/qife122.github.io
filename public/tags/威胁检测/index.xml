<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>威胁检测 on 办公AI智能小助手</title>
        <link>http://localhost:1313/tags/%E5%A8%81%E8%83%81%E6%A3%80%E6%B5%8B/</link>
        <description>Recent content in 威胁检测 on 办公AI智能小助手</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>zh-cn</language>
        <copyright>qife</copyright>
        <lastBuildDate>Fri, 08 Aug 2025 01:12:37 +0800</lastBuildDate><atom:link href="http://localhost:1313/tags/%E5%A8%81%E8%83%81%E6%A3%80%E6%B5%8B/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>利用Splunk查找表加速检测工程开发</title>
        <link>http://localhost:1313/p/%E5%88%A9%E7%94%A8splunk%E6%9F%A5%E6%89%BE%E8%A1%A8%E5%8A%A0%E9%80%9F%E6%A3%80%E6%B5%8B%E5%B7%A5%E7%A8%8B%E5%BC%80%E5%8F%91/</link>
        <pubDate>Fri, 08 Aug 2025 01:12:37 +0800</pubDate>
        
        <guid>http://localhost:1313/p/%E5%88%A9%E7%94%A8splunk%E6%9F%A5%E6%89%BE%E8%A1%A8%E5%8A%A0%E9%80%9F%E6%A3%80%E6%B5%8B%E5%B7%A5%E7%A8%8B%E5%BC%80%E5%8F%91/</guid>
        <description>&lt;h1 id=&#34;利用splunk查找表加速检测工程开发&#34;&gt;利用Splunk查找表加速检测工程开发
&lt;/h1&gt;&lt;h2 id=&#34;概述&#34;&gt;概述
&lt;/h2&gt;&lt;p&gt;本文介绍如何通过Splunk查找表(Lookups)技术快速实现基于字符串匹配的新型检测规则开发。例如当检测到&amp;quot;dump /service:krbtgt&amp;quot;这类命令时立即触发告警。虽然检测即代码(Detection-as-code)的部署可能减少此类需求，但实践表明基于字符串搜索的新规则部署周期仍然过长。&lt;/p&gt;
&lt;h2 id=&#34;背景&#34;&gt;背景
&lt;/h2&gt;&lt;p&gt;典型的新规则开发流程包括：阅读威胁报告、识别TTP独特实现方式、创建或获取规则（如从Sigma规则库获取）。即使采用检测即代码模式，这个过程仍可能非常冗长，最终导致管理数百个本质上只是字符串标识的检测规则。&lt;/p&gt;
&lt;h2 id=&#34;解决方案---使用查找表&#34;&gt;解决方案 - 使用查找表
&lt;/h2&gt;&lt;p&gt;Splunk查找表本质上是CSV格式的表格，用于存储需要检测的目标数据。我们将现有的IOC威胁匹配机制扩展到包含字符串片段（如&lt;em&gt;mimikatz&lt;/em&gt;），并指定目标字段（如command字段）。&lt;/p&gt;
&lt;h3 id=&#34;sigma规则示例&#34;&gt;Sigma规则示例
&lt;/h3&gt;&lt;p&gt;以这个检测命令行参数的Sigma规则为例，所有关注点都是CommandLine字段中的特定字符串。我们需要将此类简单Sigma规则转换为CSV结构。&lt;/p&gt;
&lt;h3 id=&#34;查找表示例&#34;&gt;查找表示例
&lt;/h3&gt;&lt;p&gt;示例查找表包含以下关键字段：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;l_field：目标字段名&lt;/li&gt;
&lt;li&gt;l_value：待检测值（支持通配符）&lt;/li&gt;
&lt;li&gt;l_description/l_name：规则描述/名称&lt;/li&gt;
&lt;li&gt;l_references：调查参考信息&lt;/li&gt;
&lt;li&gt;l_severity：风险严重等级（可用于基于风险的分析）&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;splunk搜索应用方法&#34;&gt;Splunk搜索应用方法
&lt;/h2&gt;&lt;p&gt;有三种使用查找表的SPL搜索方法，各有效能差异：&lt;/p&gt;
&lt;h3 id=&#34;方法1先使用inputlookup子搜索的tstats&#34;&gt;方法1：先使用inputlookup子搜索的Tstats
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-mysql&#34; data-lang=&#34;mysql&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tstats&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;summariesonly&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;no&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;from&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;datamodel&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Endpoint.Processes&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;where&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;rule_tuning_macro&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;inputlookup&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;string_indicator_lookup&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;rename&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;l_value&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Processes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;process&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fields&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Processes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;process&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;by&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_time&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Processes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;process&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Processes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;user&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;host&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;rename&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Proceses&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;eval&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lookup_field&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;command&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;eval&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lookup_value&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;process&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lookup&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;string_indicator_lookup&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;l_field&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lookup_field&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;l_value&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lookup_value&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;strong&gt;缺点&lt;/strong&gt;：随着查找表增大，inputlookup命令在索引器上的执行会变慢。&lt;/p&gt;
&lt;h3 id=&#34;方法2先获取全部数据再查找&#34;&gt;方法2：先获取全部数据再查找
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-mysql&#34; data-lang=&#34;mysql&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tstats&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;summariesonly&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;no&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;from&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;datamodel&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;Endpoint.Processes&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;where&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;rule_tuning_macro&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;by&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_time&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Processes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;process&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Processes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;user&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;host&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;rename&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Proceses&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;eval&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lookup_field&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;command&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;eval&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lookup_value&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;process&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lookup&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;string_indicator_lookup&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;l_field&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lookup_field&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;l_value&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;lookup_value&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;strong&gt;缺点&lt;/strong&gt;：需要先将所有命令加载到内存，大数据量时性能较低。&lt;/p&gt;
&lt;h3 id=&#34;方法3非数据模型数据的双重查找&#34;&gt;方法3：非数据模型数据的双重查找
&lt;/h3&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;{{YOUR DATA}}
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;| eval lookup_field=&amp;#34;command&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;| eval lookup_value=command
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;| search
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;[|inputlookup string_indicator_lookup | eval search=l_value |fields search | format ]
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;| lookup string_indicator_lookup l_field as lookup_field l_value as lookup_value
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;通过两次查找减少数据集规模，但未使用加速数据模型。&lt;/p&gt;
&lt;h2 id=&#34;进阶方向&#34;&gt;进阶方向
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;使用分隔符减少重复条目&lt;/li&gt;
&lt;li&gt;添加父进程等附加检测条件&lt;/li&gt;
&lt;li&gt;在查找表中存储Sigma逻辑（如ANY/ALL）&lt;/li&gt;
&lt;li&gt;探索在数据摄入时进行实时模式匹配&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;结论&#34;&gt;结论
&lt;/h2&gt;&lt;p&gt;虽然查找表方案在规模增长后可能效率下降，但其核心价值在于大幅缩短从威胁报告到实际检测的响应时间。该方法显著降低了基于字符串检测规则的开发复杂度和实施周期。&lt;/p&gt;
</description>
        </item>
        <item>
        <title>为什么托管式安全信息与事件管理(SIEM)是现代网络防御的基石</title>
        <link>http://localhost:1313/p/%E4%B8%BA%E4%BB%80%E4%B9%88%E6%89%98%E7%AE%A1%E5%BC%8F%E5%AE%89%E5%85%A8%E4%BF%A1%E6%81%AF%E4%B8%8E%E4%BA%8B%E4%BB%B6%E7%AE%A1%E7%90%86siem%E6%98%AF%E7%8E%B0%E4%BB%A3%E7%BD%91%E7%BB%9C%E9%98%B2%E5%BE%A1%E7%9A%84%E5%9F%BA%E7%9F%B3/</link>
        <pubDate>Tue, 05 Aug 2025 10:50:50 +0800</pubDate>
        
        <guid>http://localhost:1313/p/%E4%B8%BA%E4%BB%80%E4%B9%88%E6%89%98%E7%AE%A1%E5%BC%8F%E5%AE%89%E5%85%A8%E4%BF%A1%E6%81%AF%E4%B8%8E%E4%BA%8B%E4%BB%B6%E7%AE%A1%E7%90%86siem%E6%98%AF%E7%8E%B0%E4%BB%A3%E7%BD%91%E7%BB%9C%E9%98%B2%E5%BE%A1%E7%9A%84%E5%9F%BA%E7%9F%B3/</guid>
        <description>&lt;h1 id=&#34;为什么托管式安全信息与事件管理siem是现代网络防御的基石&#34;&gt;为什么托管式安全信息与事件管理(SIEM)是现代网络防御的基石
&lt;/h1&gt;&lt;p&gt;可视性是有效网络安全的基石。缺乏可视性，检测和响应恶意活动就会变成猜谜游戏，使攻击者能够悄无声息地利用漏洞。防火墙和终端代理等安全工具虽然能提供网络和主机层面的关键洞察，但这些工具通常只关注特定领域，提供的全局视角有限。&lt;/p&gt;
&lt;p&gt;安全信息与事件管理(SIEM)解决方案通过整合分析整个组织基础设施的数据来突破这些限制。这提供了更完整的威胁视图和攻击模式，将原本分散的线索串联起来。然而许多传统SIEM难以兑现这一承诺，常常用未经筛选的日志和无关警报淹没安全团队，反而将关键洞察埋没在噪音中。&lt;/p&gt;
&lt;p&gt;对于资源有限的中小企业，这些挑战更为严峻。传统SIEM需要持续调优和高技能管理才能有效运作，使其成为只有大型企业才能承担的奢侈品。不可预测的数据摄入费用更迫使企业在成本与完整可视性间做出取舍。&lt;/p&gt;
&lt;p&gt;这正是托管式SIEM的价值所在。专业的托管SIEM方案通过压缩、过滤、聚合和关联遥测数据来消除噪音、降低成本，并为安全团队提供清晰可操作的洞察。这不仅能加速检测、实现精准响应，更能让团队在威胁升级前主动狩猎。&lt;/p&gt;
&lt;h2 id=&#34;威胁狩猎的数据湖规模化集中与标准化&#34;&gt;威胁狩猎的数据湖：规模化集中与标准化
&lt;/h2&gt;&lt;p&gt;SIEM最强大的功能之一是集中化和标准化海量日志数据的能力。从服务器、终端到防火墙和云服务，大多数设备都会生成记录关键安全活动的日志。但如果没有集中管理，这些数据将保持碎片化、不一致且难以有效解读。&lt;/p&gt;
&lt;p&gt;SIEM将所有信息汇集一处，并将数据转换为统一格式。这使得应用检测规则、建立关联和分析跨系统模式成为可能。这种集中化实质上创建了威胁狩猎数据湖——调查人员可以查询、分析和交叉参考指标的统一环境。与主要关注主机行为的终端检测与响应(EDR)工具不同，SIEM提供了跨越整个基础设施的更广阔视角，能检测云日志、网络设备等非代理监控区域的异常活动。&lt;/p&gt;
&lt;p&gt;但SIEM的全部潜力需要专业管理才能释放。通过精心设计的检测规则和专家提供的上下文，托管SIEM能突出异常、用威胁情报丰富事件，并发现高风险行为。这既减轻了内部团队的操作负担，又能主动识别入侵早期指标，使组织能在威胁升级前采取行动。&lt;/p&gt;
&lt;h2 id=&#34;增强非代理设备可视性日志转发的价值&#34;&gt;增强非代理设备可视性：日志转发的价值
&lt;/h2&gt;&lt;p&gt;SIEM另一个常被低估的优势是能接收难以或无法部署代理的系统数据，包括VPN、防火墙、路由器等网络设备以及不支持代理安装的遗留服务器。这些设备往往是攻击者的首要目标。&lt;/p&gt;
&lt;p&gt;虽然这些设备可能不支持丰富的遥测功能，但几乎都支持syslog协议——计算机系统用于将事件日志发送到中央存储位置的协议。通过将这些日志转发到SIEM，组织可以实时监控认证尝试、配置变更和网络异常。&lt;/p&gt;
&lt;p&gt;经过适当解析和告警配置，托管SIEM能将基础syslog数据转化为高价值安全洞察。例如：针对多账户的单一IP重复失败登录可能预示暴力破解；来自无业务地区VPN会话激增可能表明凭证泄露。没有SIEM，这些信号很容易被忽略；有了SIEM，它们就成为明确警告。在许多情况下，此类设备的日志转发能显著改善组织可视性，监控原有盲区并为事件调查提供关键上下文。&lt;/p&gt;
&lt;h2 id=&#34;在攻击生命周期早期检测与阻断威胁&#34;&gt;在攻击生命周期早期检测与阻断威胁
&lt;/h2&gt;&lt;p&gt;威胁发现得越早，遏制所需的成本和精力就越低。这一原则是网络杀伤链的核心，该模型描述了典型入侵的各个阶段。在早期阶段捕捉攻击者可以防止事件升级为重大泄露。&lt;/p&gt;
&lt;p&gt;托管SIEM在这方面具有独特优势。通过近乎实时地收集分析遥测数据，它能在攻击者达成目标前发现恶意活动。以暴力破解攻击为例：这类通过自动尝试数千密码来攻陷RDP或VPN服务的攻击虽然噪声明显，但只有主动监控相关日志才能发现。&lt;/p&gt;
&lt;p&gt;托管SIEM实现了这种监控能力。它能对异常登录行为、过多失败认证尝试或可疑位置访问生成告警。当与其他安全工具集成时，它还能自动执行响应动作，如封锁IP、禁用账户或终止VPN会话。&lt;/p&gt;
&lt;h2 id=&#34;为什么需要专家管理&#34;&gt;为什么需要专家管理
&lt;/h2&gt;&lt;p&gt;尽管有诸多优势，传统SIEM在实践中常常表现不佳。虽然它们擅长整合标准化海量遥测数据，但需要持续调优和专业知才能保持有效。缺乏专人管理配置、调整告警和解读洞察，传统SIEM很快就会变得难以驾驭。&lt;/p&gt;
&lt;p&gt;这正是托管SIEM的价值所在。不同于将部署、配置、调优和威胁检测的负担完全压在内部团队身上，托管SIEM将技术与经验丰富的调查人员相结合，确保其产生真正的安全效益。&lt;/p&gt;
&lt;p&gt;对于没有内部安全运营中心(SOC)的组织，这种模式提供了专家监控、定制检测和主动指导。这意味着组织不仅能获得更多数据，更能获得经过正确解读、丰富和优先处理的&amp;quot;对的数据&amp;quot;，而无需建立或维护昂贵的内部门槛。&lt;/p&gt;
&lt;h2 id=&#34;黑客狩猎的强大工具&#34;&gt;黑客狩猎的强大工具
&lt;/h2&gt;&lt;p&gt;在网络威胁频率和复杂性持续攀升的当下，对全面可视性和快速检测的需求比以往任何时候都迫切。托管SIEM同时提供这两者。它能集中数据、扩展监控范围，并帮助防御者在黑客造成实际危害前采取行动。&lt;/p&gt;
&lt;p&gt;我们不应将SIEM视为过时工具或合规检查项，而应认识到它是现代网络防御的关键支柱。通过专业管理和上下文丰富，它远不止是日志聚合器——而是检测和阻断攻击的主动智能引擎，通常能在攻击开始前就将其扼杀。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;关于作者&lt;/strong&gt;&lt;br&gt;
Anton Ovrutsky是Huntress首席威胁狩猎与响应分析师，持有CISSP、OSCP等多项认证，专攻需要深入审查的安全事件调查。Dray Agha是Huntress安全运营中心高级经理，持有OSCP认证，专长数字取证和事件响应。&lt;/p&gt;
</description>
        </item>
        <item>
        <title>Stratus Red Team：专为云环境设计的对抗模拟工具</title>
        <link>http://localhost:1313/p/stratus-red-team%E4%B8%93%E4%B8%BA%E4%BA%91%E7%8E%AF%E5%A2%83%E8%AE%BE%E8%AE%A1%E7%9A%84%E5%AF%B9%E6%8A%97%E6%A8%A1%E6%8B%9F%E5%B7%A5%E5%85%B7/</link>
        <pubDate>Mon, 04 Aug 2025 04:19:59 +0800</pubDate>
        
        <guid>http://localhost:1313/p/stratus-red-team%E4%B8%93%E4%B8%BA%E4%BA%91%E7%8E%AF%E5%A2%83%E8%AE%BE%E8%AE%A1%E7%9A%84%E5%AF%B9%E6%8A%97%E6%A8%A1%E6%8B%9F%E5%B7%A5%E5%85%B7/</guid>
        <description>&lt;p&gt;今天，我激动地发布过去几周开发的新开源项目：Stratus Red Team——一款专注于模拟云环境中常见攻击技术的对抗模拟和紫队工具。&lt;/p&gt;
&lt;h3 id=&#34;开发动机&#34;&gt;开发动机
&lt;/h3&gt;&lt;p&gt;我的职业经历大量涉及威胁检测。从学校毕业后，我首先在一家专注于终端安全的本地托管检测与响应公司从事威胁检测用例工作。后来当我转到科技公司的云安全岗位时，发现云环境中的恶意活动检测面临着相似挑战。&lt;/p&gt;
&lt;p&gt;其中一个挑战是在真实环境中复现攻击者的战术、技术和程序(TTPs)，以验证我们的日志管道和检测逻辑是否端到端正常工作。对于传统终端和本地安全，已有多个开源项目如Atomic Red Team™或MITRE Caldera。但这些工具都不是云原生构建的，缺乏对云服务商的专门支持，也缺少足够数量的云环境攻击技术。&lt;/p&gt;
&lt;h3 id=&#34;stratus-red-team介绍&#34;&gt;Stratus Red Team介绍
&lt;/h3&gt;&lt;p&gt;这个项目构想始于2021年初。得益于我在Datadog担任云安全研究员的新职位，终于得以实现。我们将其作为100%免费开源软件发布！&lt;/p&gt;
&lt;p&gt;官网：https://stratus-red-team.cloud/&lt;br&gt;
GitHub：https://github.com/DataDog/stratus-red-team&lt;/p&gt;
&lt;h3 id=&#34;技术实现原理&#34;&gt;技术实现原理
&lt;/h3&gt;&lt;h4 id=&#34;攻击技术即代码&#34;&gt;攻击技术即代码
&lt;/h4&gt;&lt;p&gt;每个攻击技术由两部分组成：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Terraform代码：描述执行攻击前需要部署的基础设施&lt;/li&gt;
&lt;li&gt;Go代码：定义技术元数据及其引爆逻辑&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;以&amp;quot;停止CloudTrail日志&amp;quot;攻击技术为例：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Terraform代码创建CloudTrail Trail和S3存储桶&lt;/li&gt;
&lt;li&gt;Go代码包含技术ID、MITRE ATT&amp;amp;CK映射，以及调用cloudtrail:StopLogging API的引爆函数&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;terraform自动化&#34;&gt;Terraform自动化
&lt;/h4&gt;&lt;p&gt;项目使用Hashicorp的terraform-exec库动态管理Terraform，无需用户预装：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;自动下载Terraform二进制到~/.stratus-red-team/terraform&lt;/li&gt;
&lt;li&gt;通过编程方式调用terraform apply/destroy&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;状态存储&#34;&gt;状态存储
&lt;/h4&gt;&lt;p&gt;工具在本地文件系统维护三种状态：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;攻击技术状态&lt;/li&gt;
&lt;li&gt;先决条件的Terraform状态&lt;/li&gt;
&lt;li&gt;Terraform输出值
存储路径：~/.stratus-red-team/[technique-id]&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;架构设计决策&#34;&gt;架构设计决策
&lt;/h3&gt;&lt;h4 id=&#34;编程语言选择&#34;&gt;编程语言选择
&lt;/h4&gt;&lt;p&gt;放弃Python选择Go的主要考量：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;强类型特性提升开发效率&lt;/li&gt;
&lt;li&gt;官方Terraform封装库支持&lt;/li&gt;
&lt;li&gt;编译时错误检查&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;代价是牺牲了动态加载用户代码的扩展性，新攻击技术必须打包到主二进制中。&lt;/p&gt;
&lt;h4 id=&#34;先决设施处理&#34;&gt;先决设施处理
&lt;/h4&gt;&lt;p&gt;采用内置Terraform代码全自动管理基础设施，当前限制：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;仅支持新建资源测试&lt;/li&gt;
&lt;li&gt;不支持针对现有基础设施演练&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;合格攻击技术的标准&#34;&gt;合格攻击技术的标准
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;原子性：模拟攻击链中的单一步骤&lt;/li&gt;
&lt;li&gt;真实性：可推导出有效的威胁检测规则&lt;/li&gt;
&lt;li&gt;自包含性：不假设AWS账户的初始状态&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;未来规划&#34;&gt;未来规划
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;增加更多AWS攻击技术&lt;/li&gt;
&lt;li&gt;添加Kubernetes支持&lt;/li&gt;
&lt;li&gt;实现可选遥测功能(默认关闭)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;项目已在GitHub开源，欢迎通过Twitter或邮件提交反馈。&lt;/p&gt;
</description>
        </item>
        
    </channel>
</rss>
