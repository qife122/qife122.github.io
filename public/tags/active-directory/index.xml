<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Active Directory on 办公AI智能小助手</title>
        <link>http://localhost:1313/tags/active-directory/</link>
        <description>Recent content in Active Directory on 办公AI智能小助手</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>zh-cn</language>
        <copyright>qife</copyright>
        <lastBuildDate>Mon, 04 Aug 2025 12:12:29 +0800</lastBuildDate><atom:link href="http://localhost:1313/tags/active-directory/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>攻击Active Directory组托管服务账户(GMSA)的技术解析</title>
        <link>http://localhost:1313/p/%E6%94%BB%E5%87%BBactive-directory%E7%BB%84%E6%89%98%E7%AE%A1%E6%9C%8D%E5%8A%A1%E8%B4%A6%E6%88%B7gmsa%E7%9A%84%E6%8A%80%E6%9C%AF%E8%A7%A3%E6%9E%90/</link>
        <pubDate>Mon, 04 Aug 2025 12:12:29 +0800</pubDate>
        
        <guid>http://localhost:1313/p/%E6%94%BB%E5%87%BBactive-directory%E7%BB%84%E6%89%98%E7%AE%A1%E6%9C%8D%E5%8A%A1%E8%B4%A6%E6%88%B7gmsa%E7%9A%84%E6%8A%80%E6%9C%AF%E8%A7%A3%E6%9E%90/</guid>
        <description>&lt;h1 id=&#34;攻击active-directory组托管服务账户gmsa&#34;&gt;攻击Active Directory组托管服务账户(GMSA)
&lt;/h1&gt;&lt;p&gt;2020年5月，我在Trimarc网络研讨会&amp;quot;保护Active Directory：解决常见问题&amp;quot;中介绍了AD组托管服务账户(GMSA)的安全问题。本文是研讨会内容的扩展版本。&lt;/p&gt;
&lt;h2 id=&#34;组托管服务账户gmsa概述&#34;&gt;组托管服务账户(GMSA)概述
&lt;/h2&gt;&lt;p&gt;传统用作服务账户的用户账户很少更改密码。GMSA(自Windows 2012引入)由AD自动管理密码变更。但关键点在于：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;AD管理GMSA密码&lt;/li&gt;
&lt;li&gt;托管计算机从AD请求当前密码启动服务&lt;/li&gt;
&lt;li&gt;需明确配置允许访问密码的计算机账户&lt;/li&gt;
&lt;li&gt;若攻击者控制托管计算机或有权账户，GMSA即告失陷&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;gmsa关键属性&#34;&gt;GMSA关键属性
&lt;/h2&gt;&lt;p&gt;GMSA具有特定对象类和属性：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;msDS-GroupMSAMembership&lt;/code&gt;：存储可访问密码的安全主体&lt;/li&gt;
&lt;li&gt;&lt;code&gt;msds-ManagedPassword&lt;/code&gt;：包含密码信息的BLOB&lt;/li&gt;
&lt;li&gt;&lt;code&gt;msDS-ManagedPasswordId&lt;/code&gt;：当前密码数据的密钥标识符&lt;/li&gt;
&lt;li&gt;&lt;code&gt;msDS-ManagedPasswordInterval&lt;/code&gt;：密码自动变更间隔天数&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;攻击技术详解&#34;&gt;攻击技术详解
&lt;/h2&gt;&lt;h3 id=&#34;方法一入侵托管服务器&#34;&gt;方法一：入侵托管服务器
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;通过SPN定位托管服务器(如LCNSQL01)&lt;/li&gt;
&lt;li&gt;获取服务器管理员权限后：
&lt;ul&gt;
&lt;li&gt;使用Mimikatz执行&lt;code&gt;sekurlsa::logonpasswords&lt;/code&gt;获取服务账户凭证&lt;/li&gt;
&lt;li&gt;发现GMSA密码显示异常(如&amp;quot;&lt;em&gt;SA&lt;/em&gt;{GUID}&amp;ldquo;格式)&lt;/li&gt;
&lt;li&gt;改用&lt;code&gt;sekurlsa::ekeys&lt;/code&gt;获取正确的Kerberos票据和NT哈希&lt;/li&gt;
&lt;li&gt;实施哈希传递(PTH)攻击&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;方法二入侵有权账户&#34;&gt;方法二：入侵有权账户
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;枚举&lt;code&gt;msDS-GroupMSAMembership&lt;/code&gt;属性中的授权组(如&amp;quot;SVC-LAB-GMSA1 Group&amp;rdquo;)&lt;/li&gt;
&lt;li&gt;通过组成员关系分析发现：
&lt;ul&gt;
&lt;li&gt;11个用户账户(其中9个为普通用户)具有密码访问权&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;入侵任一授权账户后：
&lt;ul&gt;
&lt;li&gt;使用&lt;code&gt;Get-ADServiceAccount&lt;/code&gt;获取明文密码BLOB&lt;/li&gt;
&lt;li&gt;通过DSInternals的&lt;code&gt;ConvertTo-NTHash&lt;/code&gt;转换为NT哈希&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;若入侵计算机账户：
&lt;ul&gt;
&lt;li&gt;需以SYSTEM权限执行上述操作&lt;/li&gt;
&lt;li&gt;使用PSEXEC获取SYSTEM上下文&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;验证与防御&#34;&gt;验证与防御
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;验证技术&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;使用DSInternals的&lt;code&gt;Get-ADReplAccount&lt;/code&gt;确认AD中的密码哈希与获取值一致&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;防御措施&lt;/strong&gt;：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;实施最小权限原则&lt;/li&gt;
&lt;li&gt;避免将GMSA加入AD特权组(除非用于域控制器)&lt;/li&gt;
&lt;li&gt;严格限制GMSA访问权限和使用范围&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;特别感谢DSInternals的Michael Grafnetter和Mimikatz开发者Benjamin Delpy的技术支持。&lt;/p&gt;&lt;/blockquote&gt;
</description>
        </item>
        <item>
        <title>利用Active Directory进行攻击防御的技术解析</title>
        <link>http://localhost:1313/p/%E5%88%A9%E7%94%A8active-directory%E8%BF%9B%E8%A1%8C%E6%94%BB%E5%87%BB%E9%98%B2%E5%BE%A1%E7%9A%84%E6%8A%80%E6%9C%AF%E8%A7%A3%E6%9E%90/</link>
        <pubDate>Mon, 04 Aug 2025 03:36:17 +0800</pubDate>
        
        <guid>http://localhost:1313/p/%E5%88%A9%E7%94%A8active-directory%E8%BF%9B%E8%A1%8C%E6%94%BB%E5%87%BB%E9%98%B2%E5%BE%A1%E7%9A%84%E6%8A%80%E6%9C%AF%E8%A7%A3%E6%9E%90/</guid>
        <description>&lt;h1 id=&#34;webcast-weaponizing-active-directory&#34;&gt;Webcast: Weaponizing Active Directory
&lt;/h1&gt;&lt;p&gt;点击时间码跳转到视频的对应部分（在YouTube上）&lt;br&gt;
本次网络研讨会的幻灯片可以在这里找到：&lt;a class=&#34;link&#34; href=&#34;https://www.blackhillsinfosec.com/wp-content/uploads/2020/09/SLIDES_WeaponizingActiveDirectory.pdf&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;幻灯片链接&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;0:54&lt;/strong&gt; 本次网络研讨会的背景、内容和原因&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;7:02&lt;/strong&gt; 在Active Directory中创建资源：用户账户、组和虚拟计算机账户&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;18:54&lt;/strong&gt; 工具介绍：ResponderGuard、攻击的一般流程、侦察、欺骗和植入凭证&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;38:12&lt;/strong&gt; 密码喷洒、蜜罐用户、Kerberoasting攻击和组播DNS投毒&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;47:20&lt;/strong&gt; 使用CredDefense工具包进行检测：ResponderGuard、ResponderGuard代理和SQL Server滥用攻击&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;53:43&lt;/strong&gt; 问答环节和总结&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;本次网络研讨会最初于2019年8月1日由David Fletcher录制。&lt;br&gt;
2019年Verizon DBIR报告显示，超过50%的入侵事件需要一个月或更长时间才能被发现。&lt;br&gt;
本次研讨会涵盖了一些基本技术，旨在通过战术欺骗来捕捉攻击者在环境中尝试横向移动和权限提升的行为，从而缩短平均检测时间（MTTD）。&lt;/p&gt;
&lt;h3 id=&#34;准备好深入学习了吗&#34;&gt;准备好深入学习了吗？
&lt;/h3&gt;&lt;p&gt;通过Antisyphon的实惠课程提升你的技能！&lt;br&gt;
提供“按需付费”培训，支持现场/虚拟和按需学习。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;Black Hills Information Security, Inc.&lt;/strong&gt;&lt;br&gt;
890 Lazelle Street, Sturgis, SD 57785-1611 | 701-484-BHIS (2447)&lt;br&gt;
© 2008-2024&lt;br&gt;
[关于我们](About Us) | [BHIS Tribe of Companies](BHIS Tribe of Companies) | [隐私政策](Privacy Policy) | &lt;a class=&#34;link&#34; href=&#34;Contact&#34; &gt;联系我们&lt;/a&gt;&lt;/p&gt;
</description>
        </item>
        <item>
        <title>主动防御Active Directory入门指南：打造蜜罐账户与虚假SMB共享</title>
        <link>http://localhost:1313/p/%E4%B8%BB%E5%8A%A8%E9%98%B2%E5%BE%A1active-directory%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97%E6%89%93%E9%80%A0%E8%9C%9C%E7%BD%90%E8%B4%A6%E6%88%B7%E4%B8%8E%E8%99%9A%E5%81%87smb%E5%85%B1%E4%BA%AB/</link>
        <pubDate>Sun, 03 Aug 2025 02:40:31 +0800</pubDate>
        
        <guid>http://localhost:1313/p/%E4%B8%BB%E5%8A%A8%E9%98%B2%E5%BE%A1active-directory%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97%E6%89%93%E9%80%A0%E8%9C%9C%E7%BD%90%E8%B4%A6%E6%88%B7%E4%B8%8E%E8%99%9A%E5%81%87smb%E5%85%B1%E4%BA%AB/</guid>
        <description>&lt;h3 id=&#34;webcast-active-directory主动防御adad入门指南&#34;&gt;WEBCAST: Active Directory主动防御(ADAD)入门指南
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;John Strand&lt;/strong&gt; //&lt;br&gt;
本次网络研讨会中，John将讲解如何通过Active Defense Harbinger Distribution (ADHD)工具集配置Active Directory主动防御系统，并探讨《主动网络防御确定性法案》(ACDC)等法律框架。内容包括：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;创建蜜罐账户的操作演示&lt;/li&gt;
&lt;li&gt;构建具有回调功能的Word文档&lt;/li&gt;
&lt;li&gt;部署虚假SMB共享服务器
所有技术方案均免费提供。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;研讨会幻灯片下载：&lt;a class=&#34;link&#34; href=&#34;https://www.dropbox.com/s/m8c6msdfhbqc63i/HoneyAdmin_AndShare.pptx?dl=0&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;点击获取&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;进阶学习推荐&lt;/strong&gt;&lt;br&gt;
想跟随John系统提升技能？推荐以下课程：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;SOC核心技能&lt;/li&gt;
&lt;li&gt;主动防御与网络欺骗&lt;/li&gt;
&lt;li&gt;BHIS与MITRE ATT&amp;amp;CK安全入门&lt;/li&gt;
&lt;li&gt;渗透测试基础
支持直播/虚拟及点播形式学习&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;p&gt;&lt;em&gt;技术要点说明&lt;/em&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;蜜罐账户&lt;/strong&gt;：在AD中设置高权限诱饵账户，实时监控异常访问行为&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;文档回调&lt;/strong&gt;：通过特制Word文档触发攻击者连接至监控系统&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;SMB欺骗&lt;/strong&gt;：伪造共享服务器捕获凭证哈希与攻击路径信息&lt;/li&gt;
&lt;/ol&gt;
</description>
        </item>
        <item>
        <title>微软发布本地管理员密码解决方案(LAPS)工具</title>
        <link>http://localhost:1313/p/%E5%BE%AE%E8%BD%AF%E5%8F%91%E5%B8%83%E6%9C%AC%E5%9C%B0%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88laps%E5%B7%A5%E5%85%B7/</link>
        <pubDate>Sat, 02 Aug 2025 16:02:32 +0800</pubDate>
        
        <guid>http://localhost:1313/p/%E5%BE%AE%E8%BD%AF%E5%8F%91%E5%B8%83%E6%9C%AC%E5%9C%B0%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88laps%E5%B7%A5%E5%85%B7/</guid>
        <description>&lt;p&gt;こんにちは、村木ゆりかです。
今回は、マイクロソフト セキュリティ アドバイザリ 3062591 でお知らせしましたツール Local Administrator Password Solution (LAPS) についてご紹介します。&lt;/p&gt;
&lt;h3 id=&#34;local-administrator-password-solution-laps-とは&#34;&gt;Local Administrator Password Solution (LAPS) とは?
&lt;/h3&gt;&lt;p&gt;このツールは、Active Directory (AD) に参加しているコンピューターの、ローカル管理者アカウントのパスワードを AD にて管理することができる無償のツールです。&lt;/p&gt;
&lt;p&gt;攻撃者が組織に侵入する際、マルウェアなどを利用してまずはひとつのドメイン端末に侵入し、その後、Pass the Hash などの手法で同一のパスワードが設定されているその他のドメイン端末へ侵入を試みるなど、徐々に認証サーバーへ侵入するのに必要な高い権限を取得保持している可能性の高いアプリケーション・サービスを狙います。企業ではマスター イメージから複製展開する手法や、ヘルプデスク業務の効率化のために端末毎の管理者アカウントが同一になることが多く、このような場合は、一台がマルウェア感染すると他のすべての端末が侵害される可能性が高くなります。このように侵害を広げていく場合、脆弱性は不要であり、正規の認証を行い、正規の方法で不正なファイルが仕掛けられます。このような組織への侵入を阻止するためには、端末ごとの管理者アカウント パスワードの使い回しをしないことが重要になります。&lt;/p&gt;
&lt;p&gt;この LAPS ツールを利用する事で、ドメイン端末のローカル管理者アカウントのパスワードをランダムなものにし、管理を行うことができます。これにより、万が一組織内への攻撃者の侵入があった場合でも、組織内への攻撃の広がりや侵入拡大を防ぐためのセキュリティを強化することができます。&lt;/p&gt;
&lt;h3 id=&#34;laps-でのパスワード更新と管理&#34;&gt;LAPS でのパスワード更新と管理
&lt;/h3&gt;&lt;p&gt;LAPS を利用することで、各ドメイン端末のローカル管理者アカウントに、自動でランダムなパスワードを設定・定期的に更新し、AD に保存することができます。また、特定の端末のローカル管理者アカウントのパスワードをリセットするなどの管理を行うことができます。もちろん、既定の Administrator 以外のローカル管理者アカウントも管理可能です。&lt;/p&gt;
&lt;p&gt;LAPS は AD 環境でグループ ポリシーを利用して管理でき、端末から AD へパスワードを保存する際には、Kerberos V5 のプロトコルを利用し、AES で暗号化しており、AD に保存されたパスワードの情報は、特定の権限を持ったユーザーでないと閲覧することができないよう ACL で管理することができます。&lt;/p&gt;
&lt;h3 id=&#34;local-administrator-password-solution-laps-の入手&#34;&gt;Local Administrator Password Solution (LAPS) の入手
&lt;/h3&gt;&lt;p&gt;LAPS ツールは、ダウンロード センターから入手できます。
利用方法や展開方法、アーキテクチャを説明したドキュメント (英語) も、同時にダウンロードできます。
また、Ignite イベントで行われたセッションで LAPS ツールの説明やデモが行われています。ぜひ、ビデオをチェックしてみてください。&lt;/p&gt;
</description>
        </item>
        
    </channel>
</rss>
