---
date: 2025-08-05T11:45:53+08:00
title: vuLnDAP挑战全程解析：LDAP注入与SSH密钥提取实战
tags: [LDAP注入, 漏洞挖掘, 渗透测试, SSH密钥]
authors: qife
description: 本文详细解析如何通过LDAP注入技术获取系统敏感信息，包括利用通配符枚举对象类、提取posixAccount用户属性，以及意外泄露的SSH私钥利用过程，完整再现Web应用安全评估中的典型攻击路径。
---

# vuLnDAP Walkthrough 

这是关于vuLnDAP挑战的完整演练过程。当然可能存在其他解决方法，本文仅展示个人实现路径。如果您有更优方案，欢迎交流。

## 初始探测
1. 访问库存控制系统，选择水果分类时观察到URL结构：
   ```plaintext
   /fruit_or_veg?objectClass=fruits
   ```
2. 此处存在首个注入点，可通过通配符`*`获取系统所有对象（含用户和组）：
   ```plaintext
   /fruit_or_veg?objectClass=*
   ```

## 用户信息提取
选定CEO用户Fred后，发现URL包含显示控制参数：
```plaintext
/item?cn=fred&disp=stock,description,cn
```
- `disp`参数控制LDAP查询返回字段
- 通过研究`posixAccount`标准架构，补充关键字段：
  ```plaintext
  /item?cn=fred&disp=description,cn,uidNumber,gidNumber,homedirectory,userpassword
  ```

## SSH密钥泄露
1. 添加`sshPublicKey`字段成功获取Fred的公钥：
   ```plaintext
   /item?cn=fred&disp=...,sshPublicKey
   ```
2. 检查其他用户时发现意外泄露的私钥：

## 技术要点
- `userpassword`字段仅用于认证不可读取
- 通过标准LDAP架构研究确定关键字段名
- 实际渗透中需验证密钥有效性（演示密钥已做无效化处理）



---

