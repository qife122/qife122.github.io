---
date: 2025-08-02T15:40:04+08:00
title: SharePoint XSS漏洞技术分析与缓解措施
tags: [XSS, SharePoint, 漏洞挖掘, 网络安全]
authors: qife
image: 
description: 本文详细分析了SharePoint Server 2007和SharePoint Services 3.0中存在的跨站脚本(XSS)漏洞技术细节，包括攻击向量、IE8 XSS过滤器的防护机制，以及通过Http-Only cookies和ACL设置等缓解方案。
---

# SharePoint XSS漏洞

今天我们发布了安全公告983438，向客户通报SharePoint Server 2007和SharePoint Services 3.0中存在的跨站脚本(XSS)漏洞。以下是该漏洞的详细技术分析。

## 攻击向量分析
公告指出该漏洞可能导致SharePoint站点内的权限提升(EoP)。需要特别说明的是，这种权限提升并非从普通用户到工作站或服务器环境的管理员用户，而是攻击者可以在用户的SharePoint会话上下文中执行恶意脚本。最可能的攻击场景是：攻击者向已登录SharePoint服务器的用户发送恶意链接，当用户点击该链接时，攻击者嵌入的JavaScript将在点击者的用户上下文中执行。

## 缓解措施
SharePoint使用Http-Only cookies进行身份验证。由于HttpOnly cookies无法通过脚本访问，这显著降低了XSS攻击风险。更多信息请参考《使用HTTP-only Cookies缓解跨站脚本攻击》。

IE8的XSS过滤器在Internet区域默认启用，能拦截此类XSS攻击，因此IE8用户面临的风险较低。但该过滤器在本地Intranet区域默认禁用，可通过以下UI界面启用：

[图片：IE8 XSS过滤器启用界面]

管理员也可以通过组策略为任何区域启用或禁用XSS过滤器，详见《组策略与Internet Explorer 8》。

## 临时解决方案
我们建议通过服务器端ACL设置限制help.aspx文件的访问。启用此方案后，您将无法查看SharePoint站点内的帮助内容。实施此缓解措施的用户可访问以下英文帮助内容作为替代：
http://office.microsoft.com/en-us/sharepointserver/FX101211721033.aspx

Jonathan Ness, David Ross和Chengyun Chu，MSRC工程团队
*本文按"原样"提供，不作任何担保，也不授予任何权利。*