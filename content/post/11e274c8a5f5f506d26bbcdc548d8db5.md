---
date: 2025-08-07T06:45:44+08:00
title: "绕过青铜合作伙伴钱包限制：利用业务逻辑漏洞接受负余额行程"
tags: [业务逻辑漏洞, API滥用, 漏洞挖掘]
authors: qife
description: "安全研究员bugbountywithmarco发现Bykea平台存在业务逻辑漏洞，青铜级合作伙伴可通过特定API调用序列绕过钱包负余额限制，实现非法接单。漏洞涉及三个后端端点：GET /v2/:city_id/bookings、PUT /api/v2/driver/update/location和POST /api/v2/offer/bid。"
---

### 漏洞概述
安全研究员@bugbountywithmarco发现Bykea平台存在业务逻辑缺陷，允许钱包余额为负的青铜级合作伙伴绕过平台限制接受行程订单。通过串联调用三个后端API端点，负余额司机可重置其可用状态并成功提交报价。

### 技术细节
攻击链涉及以下端点调用序列：
1. 首先调用`GET /v2/:city_id/bookings`获取行程列表
2. 随后调用`PUT /api/v2/driver/update/location`（携带任意trip_id参数）
3. 最后通过`POST /api/v2/offer/bid`提交报价

这种调用方式会绕过平台对负余额账户的常规限制检查，使不符合条件的司机能够非法接受行程订单。

### 时间线
- 2024年11月27日：漏洞初次报告
- 2024年11月28日：漏洞被分类为中等风险(6.5分)
- 2025年3月27日：问题修复
- 2025年6月13日：漏洞报告公开披露

### 漏洞分类
- 弱点类型：业务逻辑错误(Business Logic Errors)
- CVE编号：无
- 风险等级：中等(6.5)